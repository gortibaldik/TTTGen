\chapter{Data}

One needs a lot of data if he wants to train his neural network. E.g. \citep{sennrich2016} trains the neural machine translation system on 4.2 million English-German sequence pairs. The Data-to-Text generation task má vyššie nároky na kvalitu datasetu. Potrebujeme, aby boli vstupné dáta štandardizované a aby výstupné texty zodpovedali vstupným dátam. Existuje viacero datasetov, ktoré spĺňajú túto podmienku. V tejto kapitole predstavím datasety WikiBIO a Rotowire.

\section{General description}

\showboxdepth=5
\showboxbreadth=5

Obidva tieto datasety používajú notáciu, ktorá bola predstavená v článku od \citep{liang-etal-2009-learning}, preto ju najprv aj tu zadefinujeme.

Ako vstup používame postupnosť záznamov (recordov) $ \mathbf{s} = \{ r_i \}_{i=1}^{J} $. Každý record $ r $ má svoj typ $ r.t \in \mathcal{T} $. Množina typov $\mathcal{T}$ je dopredu definovaná. Ďalej má typ, množinu hodnôt $ r.v = \{ r.v_1, ... , r.f_m\}$. Napríklad v datasete WeatherGOV: $ r.t == windSpeed $, $ r.v = \{time, min, mean, max, mode\}$. Na základe týchto záznamov následne predpovedáme výstupný text $ \mathbf{w} = \{ w_i\}_{i=1}^{ | \mathbf{w} | }$

\section{WikiBIO dataset}

Na to, aby som vedel rozoznať, čím je generovanie popisu športového zápasu náročné, rozhodol som sa pracovať ešte s jednou úlohou a to s generovaním krátkych životopisov na základe infoboxu z wikipédie. Touto úlohou sa zaoberali tvorcovia datasetu WikiBIO \citep{lebret2016neural}.

\subsection{Structured Data}

Charakteristikou tohoto datasetu je, že vstupná tabuľka je výrazne rôznorodá. Vyplýva to z toho, že osoby s inou kariérou majú výrazne iné charakteristiky.  U niekoho hovoríme o titule, u iného o povolaní, u niekoho spomenieme významné práce, u niekoho tímy, v ktorých hraje. Zatiaľ čo zrejme pri každej osobe sa vyskytne napríklad položka "dátum narodenia", pri žijúcich sa zrejme nevyskytne "dátum úmrtia". Dá sa teda povedať, že štruktúrované dáta z tohoto datasetu sú veľmi ťažké, pretože generačný systém nemôže predpokladať štruktúru, ale musí sa naučiť rozoznať ju. Príkladom môže byť infobox pre T.G. Masaryka \ref{img01:masaryk_infobox}.

\begin{figure}[hb!]
\centering
\begin{tikzpicture}

\node(infobox) [rectangle, draw, rounded corners] {
    \includegraphics[width=50mm,height=121mm]{img/masaryk_infobox.jpg}
};
\node(sum) [rectangle, left=0mm of infobox, text width=18em, draw, rounded corners] {
    \small
    tomáš garrigue masaryk , sometimes called thomas masaryk in english ( 7 march 1850 - 14 september 1937 ) , was a czechoslovak politician , sociologist and philosopher , who as an eager advocate of czechoslovak independence during world war i became the founder and first president of czechoslovakia .
};
\end{tikzpicture}
\caption{Príklad z trénovacích dát datasetu WikiBIO}
\label{img01:masaryk_infobox}
\end{figure}

\subsection{Summaries}

Ako sumár infoboxu slúži prvá veta z článku na wikipedii, ku ktorému prislúcha daná tabuľka. Z pozorovaní vstupných dát vyplýva, že prvá veta väčšinou obsahuje meno, dátum narodenia, prípadne dátum úmrtia a najdôležitejšie činnosti a úspechy osoby, ktorej sa infobox týka. Už z pozorovaní tvorcov datasetu \citep{lebret2016neural} vyplýva, že okolo tretiny tokenov nachádzajúcich sa v prvej vete pochádza z tabuľky. Generačný systém pracujúci s týmto datasetom teda bude musieť správne určiť, kedy sa spoľahnúť na jazykové zručnosti a kedy kopírovať. Ako príklad možno použiť sumár prislúchajúci k infoboxu \ref{img01:masaryk_infobox}.

\section{Rotowire dataset}

Pre samotnú úlohu generovania textového popisu zápasu zo štruktúrovaných dát som si vybral dataset RotoWire \citep{wiseman2017}. Štruktúrované dáta sú vo forme tabuľky. Tabuľka obsahuje jednak hodnoty popisujúce celkové tímové štatistiky, jednak hodnoty, popisujúce štatistiky hráčov. Ako výstupné dáta slúžia sumáre jednotlivých zápasov z portálu venujúcemu sa real-time fantasy sports news \url{https://www.rotowire.com/basketball/} (see below).

\subsection{Structured Data}

V tejto podsekcii si rozoberieme, aké dáta sa v tabuľke nachádzajú, a čo z nich sa dá využiť pri vytváraní sumáru. Pre prehľadnosť ich rozdelím na tri časti, kontextové údaje, tímové údaje a štatistiky a hráčske údaje a štatistiky. Keďže kontextové údaje sú vo vstupnej tabuľke zastúpené len ako informácia v ktorý deň sa zápas konal a vo väčšine sumárov táto informácia nie je použitá, rozhodol som sa ju tiež úplne vynechať z trénovacích dát. Všetky číselné údaje v tabuľkách sú tvorcami datasetu upravené na celočíselné hodnoty.

\subsubsection{Team Statistics}

Medzi tímové údaje rátam jednak mená klubov, mestá, kde kluby sídlia. \linebreak[4] Štatistiky sú jednak kontextové (počet predchádzajúcich zápasov, ktoré klub vyhral, resp. prehral) jednak zápasové (napríklad počet získaných bodov, percentuálna úspešnosť streľby z poľa atp.). Tímové údaje a štatistiky obsahujú celkovo 15 položiek pre každý tím, tvorcovia datasetu túto časť označujú ako \emph{line score} a ich celý výčet sa dá nájsť na githube tvorcov datasetu \footnote{\label{note1}\url{https://github.com/harvardnlp/boxscore-data}} Tabuľka \ref{tab_team_stats} z validačného datasetu môže poslúžiť ako dobrý príklad.

\begin{table}[bh!]
    \begin{tabular}{llllllll}
        \toprule
        Name    & City         & PTS$_1$ & AST$_2$ & REB$_3$ & TOV$_4$ & Wins & Losses  \dots \\
        \midrule
        Raptors & Toronto      & 122 & 22  & 42  & 12  & 11   & 6       \dots \\
        76ers   & Philadelphia & 95  & 27  & 38  & 14  & 4    & 14      \dots \\
        \bottomrule
        \multicolumn{8}{l}{\footnotesize \textit{Note:} The statistics are accumulated across all the team players} \\
        \multicolumn{8}{l}{\footnotesize $_1$ Points; $_2$ Assists; $_3$ Rebounds; $_4$ Turnovers}
    \end{tabular}
    \caption{Príklad tímových štatistík z datasetu Rotowire}\label{tab_team_stats}
\end{table}

\subsubsection{Player statistics}
U každého hráča je údaj, za ktorý tím hrá, či je daný tím domáci, alebo či hráč patril do starting roster, alebo nastúpil z lavičky. Štatistiky sú len zápasové a medzi ne patria napríklad počet nahraných bodov, počet minút, ktoré hráč hral atp. Hráčske údaje a štatistiky čítajú 24 položiek, tvorcovia datasetu ich nazývajú \emph{box score} a čitateľa, ktorého zaujíma kompletný výpis položiek opäť odporúčame na github tvorcov datasetu \textsuperscript{\ref{note1}} a uvádzame aj príklad tabuľky z validačného datasetu \ref{tab_player_stats}.

\begin{table}[bh!]
    \begin{tabular}{lllllll}
        \toprule
        Name             & Team City    & S\_POS$_1$ & PTS$_2$ & STL$_3$ & BLK$_4$        \dots \\
        \midrule
        Kyle Lowry       & Toronto      & G         & 24  & 1   & 0       \dots \\
        Terrence Ross    & Toronto      & N/A       & 22  & 0   & 0        \dots \\
        Robert Covington & Philadelphia & G         & 20  & 2   & 0        \dots \\
        Jahlil Okafor    & Philadelphia & C         & 15  & 0   & 1        \dots \\
        \bottomrule
        \multicolumn{6}{l}{\footnotesize \textit{Note:} $N/A$ means that the statistic couldn't be collected because it is undefined} \\
        \multicolumn{6}{l}{\footnotesize (e.g. player didn't appear on starting roster therefore his starting position is undefined)} \\
        \multicolumn{6}{l}{\footnotesize $_1$ Starting position ; $_2$ Points; $_3$ Steals; $_4$ Blocks}
    \end{tabular}
    \caption{Príklad hráčskych štatistík z datasetu Rotowire}\label{tab_player_stats}
\end{table}

\subsection{Summaries}

Kladieme vysoké nároky na sumáre. Jednak musia súvisieť s tabuľkou, jednak nechceme neurónovú sieť učiť niečo, čo by sa dalo rýchlo napísať pomocou jednoduchej šablóny. Preto potrebujeme sumáre, ktoré dokážu vytiahnuť z tabuľky hlbšie štatistiky a správne s nimi pracovať. Ako už vysvetľuje \citep{wiseman2017} obyčajné športové spravodajstvo zo stránok \url{https://www.sbnation.com/nba} nespĺňa tieto kritériá, keďže obsahuje priveľa informácií, ktoré sú založené na iných kontextoch, ako sú dáta v zápasovej tabuľke. Práve preto je zaujímavé sledovať fenomén fantasy športov.


\subsubsection{Fantasy sports}

Podľa \citep{Tozzi1999} môžeme datovať počiatky fenoménu fantasy športu do\linebreak[4]šesťdesiatych rokov dvadsiateho storočia. Podľa stránky RotoWire\footnote[2]{\url{https://www.rotowire.com/basketball/advice/}} je základom fantasy športu vytvorenie tímov reálnych hráčov z ligy a získavanie bodov na základe ich výkonov v skutočných zápasoch. Bodovanie berie do úvahy, či ide o defenzívneho, alebo ofenzívneho hráča a je nutné vybrať hráča na každú pozíciu v hre. (čím sa zaručuje, že nemôžu existovať fantasy tímy, ktoré majú len point guardov). Disponujete obmedzenými zdrojmi na nákup hráčov a hráči, u ktorých je pravdepodobnejšie, že skórujú viac bodov, resp. získajú viac lôpt a tak podobne, stoja viac. Skutočné pravidlá sú jemne zložitejšie a tí, ktorých by fantasy ligy zaujímali odporúčame na dané stránky\footnote[2].

\subsubsection{Fantasy sports news}

Na to, aby hráč mohol uspieť vo fantasy lige, potrebuje mať dokonalý prehľad o štatistikách hráčov, o trendoch, o zraneniach, o tímoch, ktorým sa darí aj o tých, ktorým sa možno začne dariť neskôr. Práve preto už od začiatku organizovania fantasy líg existujú formy spravodajstva, ktoré sa špecializujú práve na hráčov fantasy športov. Podľa legendy popísanej \citep{Tozzi1999} sa hráči jednej z prvých fantasy líg schádzali v reštaurácii La Rotisserie Francaise, a podľa tejto reštaurácie je pomenovaná aj stránka špecializujúca sa na spracovávanie štatistík pre fanúšikov fantasy líg, \url{https://www.rotowire.com/}. Články písané o zápasoch oveľa viac berú do úvahy, čo sa v zápase udialo a zároveň poskytujú aj hlbší náhľad do kontextu zápasu. Preto ako píše \citep{wiseman2017} je pre generačné systémy ideálnejšie učiť sa generovať práve články podobné tým z RotoWire. 

\subsection{Relation of summaries and tables}
\definecolor{lightblue}{rgb}{.15,.77,.90}

V tejto kapitole na jednoduchom príklade ukážem, ako sú štatistiky z tabuľky previazané so sumárom z RotoWire. Vo figure \ref{fig:samplesummary} je krásne vidieť, že väčšina údajov zo sumáru pochádza z tabuľky. Napriek tomu však text obsahuje niektoré údaje ( \sethlcolor{yellow} \hl{zvýraznené žltou farbou} ), ktoré v tabuľke vôbec nie sú a niektoré údaje (\sethlcolor{lightblue} \hl{zvýraznené modrou farbou} ), ktoré sú v tabuľke len implicitne a je ich potrebné odvodiť. Zatiaľ čo fakt, že keďže Terrence Ross má nedefinovanú štartovaciu pozíciu, tak musel nastúpiť do zápasu z lavičky je celkom zrejmý, informácia o tom, že Joel Embiid nehrá je dôležitá len vtedy, pokiaľ je Joel Embiid natoľko dôležitý hráč pre tím, že stojí za zmienku ho spomenúť. To je však kontext, ktorý v tabuľke spomenutý nie je a navyše informácia o tom, prečo nehrá nemôže byť jasná ani z kontextu celého korpusu dát.

\definecolor{lightgreen}{rgb}{.7,.9,.1}

\begin{figure*}[h!]
\centering
\scalebox{0.85}{
\begin{tikzpicture}


\node(tables)[draw, inner sep=5pt, rounded corners, text width=39em]{
    \small
    \begin{center}
        \begin{tabular}{lcccccc}
        \toprule
        {}      & WIN & LOSS & PTS$_1$ & FG\_PCT$_2$ & REB$_3$ & AST$_4$ \ldots \\
        TEAM    &     &      &     &         &    &           \\
        \midrule
        Raptors & 11  & 6    & 122 & 55      & 42 & 22        \\
        76ers   & 4   & 14   & 95  & 42      & 38 & 27        \\
        \bottomrule
        \end{tabular}
        \vspace{0.5cm}

        \begin{tabular}{llllllll}
            \toprule
            {}                & City         & PTS$_1$ & AST$_4$ & REB$_3$ & FG$_5$  & FGA$_6$ & S\_POS$_7$ $\ldots$ \\
            PLAYER            &              &     &     &     &     &     &                 \\
            \midrule
            Kyle Lowry        & Toronto      & 24  & 8   & 4   & 7   & 9   & G               \\
            Terrence Ross     & Toronto      & 22  & 0   & 3   & 8   & 11  & N/A             \\
            Robert Covington  & Philadelphia & 20  & 2   & 5   & 7   & 11  & G               \\
            Jahlil Okafor     & Philadelphia & 15  & 0   & 5   & 7   & 14  & C               \\
            DeMar DeRozan     & Toronto      & 14  & 5   & 5   & 4   & 13  & G               \\
            Jonas Valanciunas & Toronto      & 12  & 0   & 11  & 6   & 12  & C               \\
            Ersan Ilyasova    & Philadelphia & 11  & 3   & 6   & 4   & 8   & F               \\
            Sergio Rodriguez  & Philadelphia & 11  & 7   & 3   & 4   & 7   & G               \\
            Richaun Holmes    & Philadelphia & 11  & 1   & 9   & 4   & 10  & N/A             \\
            Nik Stauskas      & Philadelphia & 11  & 2   & 0   & 4   & 9   & N/A             \\
            Joel Embiid       & Philadelphia & N/A & N/A & N/A & N/A & N/A & N/A             \\
            \ldots
        \end{tabular}
    \end{center}
}; % end of node
\node(summary) [rectangle, draw,thick,fill=blue!0,text width=39em, rounded corners, inner sep =8pt, minimum height=1em, below=-2mm of tables]{
    \baselineskip=100pt
    \small
    The host Toronto Raptors defeated the Philadelphia 76ers , 122 - 95 , \sethlcolor{yellow} \hl{at Air Canada Center on Monday} . \sethlcolor{lightblue} \hl{The Raptors came into this game as a monster favorite} and they did n't leave any doubt with this result . Toronto just continuously piled it on , as they won each quarter by at least four points . The Raptors were lights - out shooting , as they went 55 percent from the field and 68 percent from three - point range . They also held the Sixers to just 42 percent from the field and dominated the defensive rebounding , 34 - 26 . Fastbreak points was a huge difference as well , with Toronto winning that battle , 21 - 6 . \sethlcolor{lightblue} \hl{Philadelphia ( 4 - 14 ) had to play this game without Joel Embiid }\sethlcolor{yellow} \hl{( rest )} and they clearly did n't have enough to compete with a potent Raptors squad . Robert Covington \sethlcolor{lightblue} \hl{had one of his best games of the season though} , tallying 20 points , five rebounds , two assists and two steals on 7 - of - 11 shooting . Jahlil Okafor \sethlcolor{lightblue} \hl{got the start for Embiid} and finished with 15 points and five rebounds . Sergio Rodriguez , Ersan Ilyasova , Nik Stauskas and Richaun Holmes all finished with 11 points a piece . \sethlcolor{yellow} \hl{The Sixers will return to action on Wednesday , when they host the Sacramento Kings for their next game .} Toronto ( 11 - 6 ) left very little doubt in this game who the more superior team is . Kyle Lowry carried the load for the Raptors , accumulating 24 points , four rebounds and eight assists . \sethlcolor{lightblue} \hl{Terrence Ross was great off the bench , scoring 22 points on 8 - of - 11 shooting .} DeMar DeRozan finished with 14 points , five rebounds and five assists . Jonas Valanciunas recorded a double - double , totaling 12 points and 11 rebounds . \sethlcolor{yellow} \hl{The Raptors next game will be on Wednesday , when they host the defensively - sound Memphis Grizzlies .} 
    \par
};
\node[rectangle, below=2mm of summary, text width=40em] {
    \footnotesize \textit{Note:} $_1$ Points; $_2$ Field Goal Percentage; $_3$ Rebounds; $_4$ Assists; $_5$ Field Goals; $_6$ Field Goals Attempted; $_7$ Starting Position; $N/A$ means undefined value
};
\end{tikzpicture}
}
\caption{ \small Príklad vstupných tabuliek a zlatého sumáru z datasetu. Žltou sú zvýraznené informácie nenachádzajúce sa v tabuľke, zatiaľ čo modrou sú zvýraznené informácie, ktoré z tabuľky a celého korpusu vyplývajú len implicitne.
}
\label{fig:samplesummary}
\end{figure*}
